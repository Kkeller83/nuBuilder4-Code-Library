<script type="text/javascript">

function setUploadStatus(id, classname, icon, status) {

    var msg = '<div class="'+ classname +'"><i class="' + icon + '"></i>' + status + '</div>'
    
    $('#' + id).html(msg)
        .fadeTo(2000, 500).slideUp(500, function() {
            $(this).html('');
        });

}

$(document).ready(function(e) {

    $('#fileToUpload').on('change', function(event) {

        var file = $(this)[0].files[0];

        var formdata = new FormData();
        formdata.append('file', file);
        formdata.append('record_id', nuCurrentProperties().record_id);

        setUploadStatus('sample_msg','alert alert-info','fa fa-spin fa-spinner','Uploading');

        $.ajax({
            type: "POST",
            url: "libs/upload/upload.php",
            data: formdata,
            contentType: false,
            cache: false,
            processData: false,
            success: function(data) {
                if (data == 'invalid') {
                    setUploadStatus('sample_msg','alert alert-info','fa fa-exclamation-triangle','File Extension invalid. Try with <strong>Pdf, docx</strong>.');
                } else {
                    
                    var result = JSON.parse(data);
                    $('#' + idRowFileName).val(result.file_name).change();
		            $('#' + idRowFileId).val(result.file_id).change();
		            
		            createDownloadLink(idRowFileName, uploadFolder, result.file_id, result.file_name);
					
					setUploadStatus('sample_msg','alert alert-success','fa fa-thumbs-up','File uploaded successfully.');
					
                }
                $("#upload-form")[0].reset();

            },
            error: function(data) {
                setUploadStatus('sample_msg','alert alert-info','fa fa-exclamation-triangle','Upload failed');
 
            }
        });
	});	
});		
</script>

<form id="upload-form" action="libs/upload/upload.php" method="post" enctype="multipart/form-data">   
    <input type="file" name="fileToUpload" id="fileToUpload">
    <input type="submit" name="submit" value="Upload">
</form>
